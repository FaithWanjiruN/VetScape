{% load static %}

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- 
    - primary meta tag
  -->
  <title>VetScape</title>

  <!-- 
    - favicon
  -->
  <link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml">

  <!-- 
    - custom css link
  -->
  <link rel="stylesheet" href="../static/css/style.css">



  <!-- 
    - google font link
  -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Bangers&family=Carter+One&family=Nunito+Sans:wght@400;700&display=swap"
    rel="stylesheet">
  
  <!-- 
    - preload images
  -->
  <link rel="preload" as="image" href="../static/images/home5.jpg">
<style>
  
.hero-title .span {
  font-size: 0.6em;
}

.hero h1 {
  margin-block: 10px ;
  margin-top: 80px;
  font-size: 7em;
}


.hero .btn {
  margin-right: 30%;
  margin-top: 30px;
}

.hero .btn:is(:hover, :focus) {
  background-color: var(--portland-orange);
}

.btnn {
  background-color: var(--black);
  color: var(--white);
  width: 150px;
  padding: 10px 25px;
  font-weight: var(--fw-700);
  border-radius: 50px;
  transition: var(--transition-1);
  margin-left: 250px;
  margin-top: 15px;
}

.btnn:is(:hover, :focus) {
  background-color: var(--portland-orange);
}
.has-scrollbar {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 20px;
  list-style: none;
  padding: 0;
  margin: 0;
}
.center-container {
  margin-left: 200px;
  justify-content: center; /* Horizontal centering */
      
}

/* Modal Background */
.modal {
  display: none; /* Hidden by default */
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent background */
  justify-content: center;
  align-items: center;
}

/* Modal Content */
.modal-content {
  background-color: #fff;
  padding: 20px;
  border-radius: 20px;
  width: 300px;
  position: relative;
  text-align: center;
}

/* Close Button */
.close {
  position: absolute;
  top: 10px;
  right: 10px;
  font-size: 18px;
  cursor: pointer;
}

/* Modal Image */
.modal-image {
  width: 100%;
  height: auto;
  border-radius: 5px;
  margin-bottom: 15px;
}

/* Adopt Button */
.adopt-btn {
  background-color: var(--portland-orange);
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  margin-left: 80px;
  margin-top: 20px;
  font-size: 13px;
}

.adopt-btn:hover {
  background-color: var(--portland-orange);
}
.adopt-btn2 {
  background-color: var(--portland-orange);
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  margin-left: 80px;
  margin-top: 20px;
  font-size: 13px;
}

.adopt-btn2:hover {
  background-color: var(--portland-orange);
}
/* Second Modal (Form Modal) Styling */
.form-content {
  width: 800px; /* Larger width for the form modal */
  max-height: 90vh;
  overflow-y: auto; /* Allow scrolling for long forms */
  padding: 50px;
}

.modal-content form-content{
  align-items: baseline;
}
/* Thank You Modal Styling */
.thank-you-content {
  width: 300px;
  padding: 20px;
  text-align: center;
  background-color: #fff;
  border-radius: 8px;
  position: relative;
}

.thank-you-icon {
  font-size: 40px;
  color: #4CAF50; /* Green color for the check mark */
  margin-bottom: 10px;
}

.thank-you-content h2 {
  font-size: 24px;
  color: #333;
}

.thank-you-content p {
  font-size: 16px;
  color: #666;
}

.thank-you-btn {
  background-color: #4CAF50;
  color: #fff;
  border: none;
  padding: 10px 20px;
  font-size: 16px;
  border-radius: 4px;
  cursor: pointer;
  margin-top: 20px;
}

.thank-you-btn:hover {
  background-color: #45a049;
}

/* General modal overlay styling */
.modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.5);
  justify-content: center;
  align-items: center;
}




</style>
</head>

<body id="top">

  <!-- 
    - #HEADER
  -->

  <header class="header" data-header>
    <div class="container">

      <button class="nav-toggle-btn" aria-label="toggle manu" data-nav-toggler>
        <ion-icon name="menu-outline" aria-hidden="true" class="menu-icon"></ion-icon>
        <ion-icon name="close-outline" aria-label="true" class="close-icon"></ion-icon>
      </button>

      <a href="" class="logo">VetScape</a>

      <nav class="navbar" data-navbar>
        <ul class="navbar-list">

          <li class="navbar-item">
            <a href="#home" class="navbar-link" data-nav-link>Home</a>
          </li>

          <li class="navbar-item">
            <a href="#category1" class="navbar-link" data-nav-link>Adopt</a>
          </li>

          <li class="navbar-item">
            <a href="#category1" class="navbar-link" data-nav-link>Clinics & Vet Centers</a>
          </li>

          <li class="navbar-item">
            <a href="#footer1" class="navbar-link" data-nav-link>Contact</a>
          </li>

        </ul>

      </nav>

      <div class="header-actions">

        <button class="action-btn" aria-label="Search">
          <ion-icon name="search-outline" aria-hidden="true"></ion-icon>
        </button>

        <a href="{% url 'login' %}"  class="navbar-action-btn">Log In</a>
      </div>

    </div>
  </header>





  <main>
    <article>

      <!-- 
        - #HERO
      -->

      <section class="section hero has-bg-image" id="home" aria-label="home"
        style="background-image: url('../static/images/home5.jpg')">
        <div class="container">

          <h1 class="h1 hero-title">
            <span class="span">Adopt love</span> One Paw at a Time
          </h1>

          <p class="hero-text" style="margin-left: 250px; font-size: 24px;">Every dog deserves a happy home!</p>

          <a href="#category1" class="btn">Adopt Now</a>
          

        </div>
      </section>





      <!-- 
        - #CATEGORY
      -->

      <section class="section category" aria-label="category" id="category1">
        <div class="container">

          <h2 class="h2 section-title">
            <span class="span">Our</span> Furry Friends
          </h2>
          <h3 class="h2 section-title" style="font-size: 20px;"> Meet the Dogs in Our Care </h3>

          <div class="center-container">
            <ul class="has-scrollbar">

            <li class="scrollbar-item">
              <div class="category-card">

            <!-- Card Structure -->
            <figure class="card-banner img-holder" data-image="../static/images/dog1.jpg" data-breed="Seberian Husky"  data-id="56721" data-status="Vaccinated"data-fact="Scout loves playing fetch and swimming in pools and lakes!" onclick="openModal(this)">
              <img src="../static/images/dog1.jpg" width="330" height="300" loading="lazy" alt="Scout" class="img-cover">
            </figure>

            <!-- Modal Structure (only one modal needed) -->
            <div id="modal" class="modal">
              <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
                <img id="modalImage" class="modal-image" alt="Pet Image">
                <p id="modalText" class="modal-text"></p>
                <button onclick="openFormModal()" class="adopt-btn">Adopt Now</button>
              </div>
            </div>
            
            <!-- Second Modal for the Adoption Form -->
            <div id="formModal" class="modal">
              <div class="modal-content form-content">
                <span class="close" onclick="closeFormModal()">&times;</span>
                <h2 class="h2 section-title">
                  <span class="span">Dog</span>  Adoption Form
                </h2>

                <form id="adoptionForm" method="POST">
                  {% csrf_token %}
                  <h3 class="h3 section-title">
                    Your Contact <span class="span">Information</span>
                  </h3>
                  <label>First Name</label>
                  <input type="text" name="firstName" required>
                  <label>Last Name</label>
                  <input type="text" name="lastName" required>
                  <label>Address</label>
                  <input type="text"required>
                  <label>City/State</label>
                  <input type="text"required>
                  <label>Zipcode</label>
                  <input type="text"required>
                  <label>Phone</label required>
                  <input type="text"required>
                  <label>Email</label>
                  <input type="email"required oninvalid="this.setCustomValidity('Please enter a valid email address.')"
                  oninput="this.setCustomValidity('')">
            
                  <h3 class="h3 section-title">
                    Your <span class="span">Home</span>
                  </h3>
                  <label>What type of housing do you live in?</label>
                  <div class="checkbox-group">
                    <input type="checkbox"> Apartment
                    <input type="checkbox"> House
                    <input type="checkbox"> Others <input type="text">
                  </div>
                  
                  <label>Do you rent this property? If yes, fill the landlord's name</label>
                  <div class="checkbox-group">
                    <input type="checkbox"> No
                    <input type="checkbox"> Yes, Landlord's Name <input type="text">
                  </div>
            
                  <h3 class="h3 section-title">
                    General <span class="span">Information</span>
                  </h3>
                  <label>Why do you want to adopt this pet?</label>
                  <div class="checkbox-group">
                    <input type="checkbox"> Companion for child
                    <input type="checkbox"> Companion for other pet
                    <input type="checkbox"> Companion for self
                    <input type="checkbox"> Service animal
                    <input type="checkbox"> Security
                    <input type="checkbox"> House pet
                    <input type="checkbox"> Breeding
                    <input type="checkbox"> Others <input type="text">
                  </div>
                  
                  <label>Have you previously owned pets?</label>
                  <div class="checkbox-group">
                    <input type="checkbox"> No
                    <input type="checkbox"> Yes
                  </div>
                  
                  <label>Please list any animals you have currently or have had in the past five years</label>
                  <textarea></textarea>
                  <br>
                  <label>I hereby agree to adopt the animals and take good care of them</label>
                  <div class="checkbox-group">
                    <input type="checkbox"required> Agree
                  </div>
                  <h3 class="h3 section-title">
                    Pet <span class="span">Information</span>
                  </h3>
                  <label>Pet ID#</label>
                  <input type="text"required>
                  <label>Breed</label>
                  <input type="text"required>
                  <label>Age/Sex</label>
                  <input type="text"required>
                  <label>Approved</label>
                  <input type="text"required>
                  <label>Date</label>
                  <input type="date"required>

                  
            
                  <button type="submit">Submit</button>
                  
                  <!-- Thank You Modal -->
                  <div id="thankYouModal" class="modal">
                    <div class="modal-content thank-you-content">
                      <span class="close" onclick="closeThankYouModal()">&times;</span>
                      <div class="thank-you-icon">✔</div> <!-- This will mimic the checkmark -->
                      <h2>Thank You!</h2>
                      <p>Your details have been successfully submitted. Thanks!</p>
                      <button onclick="closeThankYouModal()" class="thank-you-btn">OK</button>
                    </div>
                  </div>

                </form>
              </div>
            </div>



                <h3 class="h3">
                  <a href="" class="card-title">Scout <br> 6 years </a>
                </h3>

              </div>
            </li>

            <li class="scrollbar-item">
              <div class="category-card">

              <figure class="card-banner img-holder" data-image="../static/images/dog2.jpg" data-breed="Dobberman" data-id="12345" data-status="Vaccinated" data-fact="Dash loves playing fetch!Scout loves playing fetch" onclick="openModal(this)">
              <img src="../static/images/dog2.jpg" width="330" height="300" loading="lazy" alt="Dash" class="img-cover">
            </figure>

                <h3 class="h3">
                  <a href="" class="card-title">Dash <br> 5 years </a>
                </h3>

              </div>
            </li>

            <li class="scrollbar-item">
              <div class="category-card">

                <figure class="card-banner img-holder" data-image="../static/images/dog14.jpg" data-breed="Poodle" data-id="12345" data-status="Vaccinated" data-fact="Teddy loves playing fetch!Scout loves playing fetch" onclick="openModal(this)">
                  <img src="../static/images/dog14.jpg" width="330" height="300" loading="lazy" alt="Teddy" class="img-cover">
                </figure>

                <h3 class="h3">
                  <a href="" class="card-title">Teddy <br> 4 years</a>
                </h3>

              </div>
            </li>

            <li class="scrollbar-item">
              <div class="category-card">

                <figure class="card-banner img-holder" data-image="../static/images/dog13.jpg" data-breed="Rottweiler" data-id="12345" data-status="Not Vaccinated" data-fact="Roxy loves playing fetch!Scout loves playing fetch" onclick="openModal(this)">
                  <img src="../static/images/dog13.jpg" width="330" height="300" loading="lazy" alt="Roxy" class="img-cover">
                </figure>

                <h3 class="h3">
                  <a href="" class="card-title">Roxy <br> 2 years </a>
                </h3>

              </div>
            </li>


            <br>
            <li class="scrollbar-item">
              <div class="category-card">

                <figure class="card-banner img-holder" data-image="../static/images/dog10.jpg" data-breed="DachSchund" data-id="12345" data-status="Vaccinated" data-fact="Rex loves playing fetch!Scout loves playing fetch" onclick="openModal(this)">
                  <img src="../static/images/dog10.jpg" width="330" height="300" loading="lazy" alt="Rex" class="img-cover">
                </figure>

                <h3 class="h3">
                  <a href="" class="card-title">Rex <br> 1 year </a>
                </h3>

              </div>
            </li>

            <li class="scrollbar-item">
              <div class="category-card">

                <figure class="card-banner img-holder" data-image="../static/images/dog5.jpg" data-breed="Golden Retriever" data-id="12345" data-status="Not Vaccinated" data-fact="Maple loves playing fetch!Scout loves playing fetch" onclick="openModal(this)">
                  <img src="../static/images/dog5.jpg" width="330" height="300" loading="lazy" alt="Maple" class="img-cover">
                </figure>

                      <h3 class="h3">
                  <a href="" class="card-title">Maple <br> 1.5 years </a>
                </h3>

              </div>
            </li>

            <li class="scrollbar-item">
              <div class="category-card">

                <figure class="card-banner img-holder" data-image="../static/images/dog12.jpg" data-breed="Yorkshier" data-id="12345" data-status="Vaccinated" data-fact="Ace loves playing fetch!Scout loves playing fetch" onclick="openModal(this)">
                  <img src="../static/images/dog12.jpg" width="330" height="300" loading="lazy" alt="Ace" class="img-cover">
                </figure>

                <h3 class="h3">
                  <a href="" class="card-title">Ace <br> 2 years </a>
                </h3>

              </div>
            </li>

            <li class="scrollbar-item">
              <div class="category-card">

                <figure class="card-banner img-holder" data-image="../static/images/dog11.jpg" data-breed="Dobberman" data-id="12345" data-status="Not Vaccinated" data-fact="Zuko loves playing fetch!Scout loves playing fetch" onclick="openModal(this)">
                  <img src="../static/images/dog11.jpg" width="330" height="300" loading="lazy" alt="Zuko" class="img-cover">
                </figure>

                <h3 class="h3">
                  <a href="" class="card-title">Zuko <br> 1 year</a>
                 
                </h3>

              </div>
            </li>

            </ul>
          </div>


        </div>
       
      </section>

       <!-- 
        - #CATEGORY2
      -->
      <section class="section category2" aria-label="category2" id="category2">
        <div class="container">

          <h2 class="h2 section-title">
            <span class="span">Nearest</span> Vet Centers
          </h2>
          <h3 class="h2 section-title" style="font-size: 20px;"> Let's help you find the nearest centers </h3>
          
          <!-- Location Dropdown -->
<form method="get">
  <label for="location">Select a Location:</label>
  <select id="location" name="location" onchange="fetchClinicsByLocation(this.value)">
      <option value="">All Locations</option>
      <option value="Westlands">Westlands</option>
      <option value="Kasarani">Kasarani</option>
      <option value="Embakasi">Embakasi</option>
      <option value="Langata">Langata</option>
  </select>
</form>

<!-- "Find Clinics Near Me" Button -->
<div class="center-container">
  <button class="adopt-btn" onclick="getLocationAndFetchClinics()">Find Clinics Near Me</button>
</div>

<!-- Dynamic Clinic List -->
<div class="center-container">
  <ul class="has-scrollbar" id="clinic-list">
      <!-- Clinics will be dynamically loaded here -->
  </ul>
</div>

        
          </section>      
        </div>
    </article>
  </main>

  <!-- 
    - #FOOTER
  -->

  <footer class="footer" id=footer1 style="background-image: url('./static/images/footer-bg.jpg')">

    <div class="footer-top section">
      <div class="container">

        <div class="footer-brand">

          <a href="#" class="logo">VetScape</a>

          <p class="footer-text">
            If you have any question, please contact us at <a href="mailto:VetScape@gmail.com"
              class="link">VetScape@gmail.com</a>
          </p>

          <ul class="contact-list">

            <li class="contact-item">
              <ion-icon name="location-outline" aria-hidden="true"></ion-icon>

              <address class="address">
                Thika Road, Chicken Road 10010
              </address>
            </li>

            <li class="contact-item">
              <ion-icon name="call-outline" aria-hidden="true"></ion-icon>

              <a href="tel:+254796933322" class="contact-link">(+254)-0796933322</a>
            </li>

          </ul>

          <ul class="social-list">

            <li>
              <a href="#" class="social-link">
                <ion-icon name="logo-facebook"></ion-icon>
              </a>
            </li>

            <li>
              <a href="#" class="social-link">
                <ion-icon name="logo-twitter"></ion-icon>
              </a>
            </li>

            <li>
              <a href="#" class="social-link">
                <ion-icon name="logo-pinterest"></ion-icon>
              </a>
            </li>

            <li>
              <a href="#" class="social-link">
                <ion-icon name="logo-instagram"></ion-icon>
              </a>
            </li>

          </ul>

        </div>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="container">

        <p class="copyright">
          &copy; 2022 Made with ♥ by <a href="#" class="copyright-link">VetScape.</a>
        </p>
      </div>
    </div>

  </footer>




 <!-- 
    - #BACK TO TOP
  -->

  <a href="#top" class="back-top-btn" aria-label="back to top" data-back-top-btn>
    <ion-icon name="chevron-up" aria-hidden="true"></ion-icon>
  </a>





  <!-- 
    - custom js link
  -->
  <script src="../static/js/script.js" defer></script>
<script>
// Open the modal and populate it with data from the clicked figure
function openModal(element) {
    const imageSrc = element.getAttribute("data-image");
    const petBreed = element.getAttribute("data-breed");
    const petId = element.getAttribute("data-id");
    const petStatus = element.getAttribute("data-status");
    const petFact = element.getAttribute("data-fact");
  
    // Populate modal content with the data
    document.getElementById("modalImage").src = imageSrc;
    document.getElementById("modalText").innerHTML = `
      Breed: ${petBreed}<br>
      ID: ${petId}<br>
      Status: ${petStatus}<br>
      Fact: ${petFact}
    `;
  
    document.getElementById("modal").style.display = "flex";
  }
  
  // Close the first modal
  function closeModal() {
    document.getElementById("modal").style.display = "none";
  }
  
  // Open the form modal and close the first modal
  function openFormModal() {
    closeModal();
    document.getElementById("formModal").style.display = "flex";
  }
  
  // Close the form modal
  function closeFormModal() {
    document.getElementById("formModal").style.display = "none";
  }
  
  // Open the Thank You modal
  function openThankYouModal() {
    document.getElementById("thankYouModal").style.display = "flex";
  }
  
  // Close the Thank You modal
  function closeThankYouModal() {
    document.getElementById("thankYouModal").style.display = "none";
    document.getElementById("formModal").style.display = "none";
  }
  
  // Add event listener to form submission
document.querySelector('form').addEventListener('submit', function (event) {
  event.preventDefault(); // Prevent default form submission

  // Check if the form is valid
  if (this.checkValidity()) {
    openThankYouModal(); // Open the Thank You modal
    this.reset(); // Reset the form after successful submission
    document.querySelector('.adopt-btn2').disabled = true; // Disable submit button after reset
  } else {
    // Alert user and focus on the first invalid field
    alert('Please fill in all required fields correctly!');
    const firstInvalidField = this.querySelector(':invalid');
    if (firstInvalidField) {
      firstInvalidField.focus();
    }
  }
});

// Disable the submit button until the form is valid
const form = document.querySelector('form');
const submitButton = document.querySelector('.adopt-btn2');
submitButton.disabled = true; // Disable the button initially

form.addEventListener('input', function () {
  submitButton.disabled = !this.checkValidity(); // Enable/disable button based on form validity
});

  // Validate checkbox groups
  function validateCheckboxGroup(groupSelector) {
    const checkboxes = document.querySelectorAll(groupSelector);
    return Array.from(checkboxes).some(checkbox => checkbox.checked);
  }
  
  // Add custom validation for checkbox groups and display feedback
  form.addEventListener('submit', function (event) {
    const housingValid = validateCheckboxGroup('input[name="housingType"]');
    if (!housingValid) {
      alert('Please select at least one housing type.');
      event.preventDefault();
      return;
    }
  });
  
  // Add custom validation message for email field
  document.querySelector('input[type="email"]').addEventListener('input', function () {
    if (this.validity.typeMismatch) {
      this.setCustomValidity('Please enter a valid email address.');
    } else {
      this.setCustomValidity('');
    }
  });
  
  // Close modals if clicked outside their content
  window.onclick = function (event) {
    if (event.target == document.getElementById("modal")) {
      closeModal();
    } else if (event.target == document.getElementById("formModal")) {
      closeFormModal();
    } else if (event.target == document.getElementById("thankYouModal")) {
      closeThankYouModal();
    }
  };
  

// Function to open the modal and populate it with data from the clicked figure
function openModal(element) {
  // Get data attributes from the clicked figure element
  const imageSrc = element.getAttribute("data-image");
  const petBreed = element.getAttribute("data-breed");
  const petId = element.getAttribute("data-id");
  const petStatus =element.getAttribute("data-status");
  const petFact = element.getAttribute("data-fact");

  // Populate modal content with the data
  document.getElementById("modalImage").src = imageSrc;
  document.getElementById("modalText").innerHTML = `Breed: ${petBreed}<br> ID: ${petId}<br> Status: ${petStatus} <br>Fact: ${petFact}`;

  // Display the modal
  document.getElementById("modal").style.display = "flex";
}

// Function to close the first modal
function closeModal() {
  document.getElementById("modal").style.display = "none";
}

// Function to open the form modal and close the first modal
function openFormModal() {
  closeModal();
  document.getElementById("formModal").style.display = "flex";
}

// Function to close the form modal
function closeFormModal() {
  document.getElementById("formModal").style.display = "none";
}

// Close modals if clicked outside the content
window.onclick = function(event) {
  if (event.target == document.getElementById("modal")) {
    closeModal();
  } else if (event.target == document.getElementById("formModal")) {
    closeFormModal();
  }
};

// Function to open the Thank You modal
function openThankYouModal() {
  document.getElementById("thankYouModal").style.display = "flex";
}

// Function to close the Thank You modal
function closeThankYouModal() {
  document.getElementById("thankYouModal").style.display = "none";
  document.getElementById("formModal").style.display = "none";
}

// Add event listener to the submit button to open Thank You modal on click
document.querySelector('.adopt-btn2').addEventListener('click', function(event) {
  event.preventDefault(); // Prevent form submission for now
  openThankYouModal();
});

  // Fetch clinics by location from dropdown
function fetchClinicsByLocation(location) {
    const clinicList = document.getElementById('clinic-list');
    clinicList.innerHTML = '<li>Loading clinics...</li>'; // Display a loading message

    fetch(`/clinics/?location=${location}`)
        .then(response => response.json()) // Expect JSON data from the backend
        .then(data => {
            clinicList.innerHTML = ''; // Clear the loading message
            if (data.clinics.length > 0) {
                data.clinics.forEach(clinic => {
                    clinicList.innerHTML += `
                        <li class="scrollbar-item">
                            <div class="category-card">
                                <figure class="card-banner img-holder" style="--width: 330; --height: 300;">
                                    <img src="../static/images/clinic_placeholder.jpg" 
                                         width="330" height="300" 
                                         loading="lazy" 
                                         alt="${clinic.name}" 
                                         class="img-cover">
                                </figure>
                                <h3 class="h3">
                                    <a href="" class="card-title">${clinic.name}</a>
                                </h3>
                                <p><strong>Address:</strong> ${clinic.address}</p>
                            </div>
                        </li>`;
                });
            } else {
                clinicList.innerHTML = '<li>No clinics found for the selected location.</li>';
            }
        })
        .catch(error => {
            console.error('Error fetching clinics:', error);
            clinicList.innerHTML = '<li>Failed to load clinics. Please try again later.</li>';
        });
}

// Fetch nearby clinics using geolocation
function getLocationAndFetchClinics() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(success, error);
    } else {
        alert("Geolocation is not supported by this browser.");
    }
}

function fetchClinicsByLocation(location) {
    fetch(`/clinics/?location=${location}`)
        .then(response => response.json())
        .then(data => {
            let clinicList = document.getElementById("clinic-list");
            clinicList.innerHTML = "";  // Clear the existing list

            data.clinics.forEach(clinic => {
                let clinicHTML = `
                    <li class="scrollbar-item">
                        <div class="category-card">
                            <figure class="card-banner img-holder" style="--width: 330; --height: 300;">
                                <img src="${clinic.image_url}" width="330" height="300" loading="lazy" alt="${clinic.name}" class="img-cover">
                            </figure>
                            <h3 class="h3">
                                <a href="" class="card-title">${clinic.name}</a>
                            </h3>
                            <p>${clinic.address}</p>
                        </div>
                    </li>`;
                clinicList.innerHTML += clinicHTML;
            });
        })
        .catch(error => console.error('Error:', error));
}


function success(position) {
    const latitude = position.coords.latitude;
    const longitude = position.coords.longitude;

    // Send the location data to the Django backend
    fetch(`/clinics/nearby/?lat=${latitude}&lng=${longitude}`)
        .then(response => response.json())
        .then(data => {
            const clinicList = document.getElementById('clinic-list');
            clinicList.innerHTML = ''; // Clear the list
            if (data.clinics.length > 0) {
                data.clinics.forEach(clinic => {
                    clinicList.innerHTML += `
                        <li class="scrollbar-item">
                            <div class="category-card">
                                <figure class="card-banner img-holder" style="--width: 330; --height: 300;">
                                    <img src="../static/images/clinic_placeholder.jpg" 
                                         width="330" height="300" 
                                         loading="lazy" 
                                         alt="${clinic.name}" 
                                         class="img-cover">
                                </figure>
                                <h3 class="h3">
                                    <a href="" class="card-title">${clinic.name}</a>
                                </h3>
                                <p><strong>Address:</strong> ${clinic.address}</p>
                            </div>
                        </li>`;
                });
            } else {
                clinicList.innerHTML = '<li>No nearby clinics found.</li>';
            }
        })
        .catch(error => {
            console.error('Error fetching nearby clinics:', error);
            clinicList.innerHTML = '<li>Failed to load nearby clinics. Please try again later.</li>';
        });
}

function error() {
    alert("Unable to retrieve your location.");
}


document.getElementById("adoptionForm").addEventListener("submit", function (event) {
    // Get all input elements with the 'required' attribute
    const requiredFields = this.querySelectorAll("input[required], textarea[required]");
    let allValid = true;

    // Check each field
    requiredFields.forEach(field => {
      if (!field.value.trim()) {
        allValid = false;
        // Highlight the field and show an error message
        field.style.border = "2px solid red";
        field.setAttribute("placeholder", "This field is required");
      } else {
        field.style.border = ""; // Reset border if valid
      }
    });

    // Prevent form submission if not all fields are valid
    if (!allValid) {
      event.preventDefault();
      alert("Please fill out all required fields.");
    }
  });
  

  document.getElementById('adoptionForm').addEventListener('submit', function(event) {
  event.preventDefault(); // Prevent the default form submission

  // Collect form data
  var formData = new FormData(this);

  // Get CSRF token from cookies
  var csrfToken = getCookie('csrftoken'); // Ensure getCookie function is correctly defined

  // Send the form data to the Django server
  fetch('/send-adoption-email/', {  // Change this URL to your Django view
    method: 'POST',
    headers: {
      'X-CSRFToken': csrfToken // CSRF token in headers
    },
    body: formData
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      // Display thank you modal on success
      document.getElementById('thankYouModal').style.display = 'block';
    } else {
      alert('There was an error. Please try again.');
    }
  })
  .catch(error => {
    console.error('Error:', error);
    alert('There was an error. Please try again.');
  });
});


</script>

  <!-- 
    - ionicon link
  -->
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
 
    
</body>

</html>